---
import AnimatedBackground from '../../components/AnimatedBackground.astro'
import SectionDivider from '../../components/SectionDivider.astro'
import BaseLayout from '../../layouts/BaseLayout.astro'
import projectsData from '../../data/projects.json'

export function getStaticPaths() {
  return projectsData.projects.map((project) => ({
    params: { slug: project.id },
    props: { project }
  }))
}

interface Project {
  id: string
  title: string
  description: string
  caseStudy?: {
    overview?: string
    challenge?: string
    approach?: string
    outcome?: string
    techStack?: string[]
  }
}

const { project } = Astro.props as { project: Project }
const { slug } = Astro.params
---

<BaseLayout title={`${project.title} | Chris Lacey`} description={project.description}>
  <div class="min-h-[calc(100vh-60px)] bg-[#0F0F16] text-white selection:bg-teal-400/30 selection:text-teal-200">
    <AnimatedBackground />

    <div class="relative mx-auto max-w-4xl px-6 py-12 md:px-12 md:py-20 lg:py-24">
      <!-- Project Header -->
      <header class="mb-12">
        <a
          href="/projects"
          class="group inline-flex items-center gap-2 text-sm font-medium text-text-muted hover:text-teal-400 transition-colors mb-8"
        >
          <svg class="h-4 w-4 transition-transform duration-200 group-hover:-translate-x-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16l-4-4m0 0l4-4m-4 4h18" />
          </svg>
          Back to Projects
        </a>

        <h1
          class="text-3xl font-bold md:text-4xl lg:text-5xl gradient-heading"
          transition:name="page-title"
        >
          {project.title}
        </h1>

        <p
          class="mt-6 text-lg leading-relaxed text-text-muted-light max-w-2xl"
          transition:name="intro-text"
        >
          {project.description}
        </p>
      </header>

      <SectionDivider class="my-12" />

      <!-- Case Study Content Placeholder -->
      {project.caseStudy ? (
        <article class="space-y-16" transition:name="main-content">
          {project.caseStudy.overview && (
            <section>
              <h2 class="text-sm font-semibold uppercase tracking-[0.2em] text-teal-400/70 mb-6">Overview</h2>
              <p class="max-w-prose text-text-muted-light leading-relaxed">{project.caseStudy.overview}</p>
            </section>
          )}

          {project.caseStudy.challenge && (
            <section>
              <h2 class="text-sm font-semibold uppercase tracking-[0.2em] text-teal-400/70 mb-6">The Challenge</h2>
              <p class="max-w-prose text-text-muted-light leading-relaxed">{project.caseStudy.challenge}</p>
            </section>
          )}

          {project.caseStudy.approach && (
            <section>
              <h2 class="text-sm font-semibold uppercase tracking-[0.2em] text-teal-400/70 mb-6">Approach</h2>
              <p class="max-w-prose text-text-muted-light leading-relaxed">{project.caseStudy.approach}</p>
            </section>
          )}

          {project.caseStudy.outcome && (
            <section>
              <h2 class="text-sm font-semibold uppercase tracking-[0.2em] text-teal-400/70 mb-6">Outcome</h2>
              <p class="max-w-prose text-text-muted-light leading-relaxed">{project.caseStudy.outcome}</p>
            </section>
          )}

          {project.caseStudy.techStack && project.caseStudy.techStack.length > 0 && (
            <section>
              <h2 class="text-sm font-semibold uppercase tracking-[0.2em] text-teal-400/70 mb-6">Tech Stack</h2>
              <div class="flex flex-wrap gap-3">
                {project.caseStudy.techStack.map((tech) => (
                  <span class="px-4 py-2 rounded-full border border-white/[0.08] bg-white/[0.02] text-sm text-text-muted-light">
                    {tech}
                  </span>
                ))}
              </div>
            </section>
          )}
        </article>
      ) : (
        <!-- Coming Soon State -->
        <div class="flex flex-col items-center justify-center py-16 text-center" transition:name="main-content">
          <div class="relative mb-8">
            <div class="absolute inset-0 blur-2xl bg-teal-400/10 rounded-full"></div>
            <svg class="relative h-16 w-16 text-teal-400/40" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z" />
            </svg>
          </div>
          <h2 class="text-xl font-semibold text-white mb-3">Case Study Coming Soon</h2>
          <p class="text-text-muted max-w-md mb-8">
            I'm currently documenting the architecture decisions, tradeoffs, and implementation details for this project.
          </p>

          <div class="flex flex-col sm:flex-row gap-4">
            <a
              href="/about"
              class="group inline-flex items-center gap-2 text-sm font-medium text-text-muted-light hover:text-white transition-colors"
            >
              See how I work
              <svg class="h-4 w-4 transition-transform duration-200 group-hover:translate-x-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
              </svg>
            </a>
            <span class="hidden sm:block text-text-muted/30">|</span>
            <a
              href="/projects"
              class="group inline-flex items-center gap-2 text-sm font-medium text-teal-400 hover:text-teal-300 transition-colors"
            >
              View other projects
              <svg class="h-4 w-4 transition-transform duration-200 group-hover:translate-x-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
              </svg>
            </a>
          </div>
        </div>
      )}
    </div>
  </div>
</BaseLayout>
